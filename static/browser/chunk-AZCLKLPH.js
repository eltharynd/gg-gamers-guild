import{a as he}from"./chunk-HEGXEUWN.js";import{A as te,B as ie,C as ne,D as re,E as oe,G as ae,H as le,I as me,J as de,K as se,L as pe,M as ce,N as ue,O as fe,P as ve,Q as ge,R as _e,S as xe,T as Ee,U as Ce,V as be,f as O,h as z,m as Q,n as H,o as Y,p as Z,q as g,r as J,s as K,t as F,u as x,v as U,w as W,x as X,y as ee,z as P}from"./chunk-WFIQQ7GG.js";import{Ab as v,Cb as w,Dc as R,Ec as q,Fb as E,Gc as j,Hb as C,J as V,Lb as B,Mb as A,Nb as $,Ob as L,Pb as a,Qb as T,Rb as f,Ya as m,Za as G,Zb as c,_b as u,ea as N,fa as S,g as y,ia as b,ja as h,nb as _,pa as D,pb as p,qa as I,yb as n,zb as e}from"./chunk-HAPHMHIP.js";var ye=(()=>{let t=class t{constructor(){this.timeCorrector=i=>{if(/^[0-2][0-9]$/.test(i.value))i.setValue(`${i.value}:00`),console.log(`${i.value}:00`);else if(/^[0-2][0-9][0-9][0-9]$/.test(i.value)){let l=i.value.toString();i.setValue(`${l.substring(0,2)}:${l.substring(2,4)}`),console.log(`${l.substring(0,2)}:${l.substring(2,4)}`)}},this.timeValidator=i=>{if(/^[0-2][0-9]\:[0-9][0-9]$/.test(i.value))return null;{let l={};return l.time=i.value,l}},this.arrayValidator=i=>i.value?.length===0?{emptyArray:i.value?.length}:null,this.futureDateValidator=i=>{let l=new Date(i.value),r=new Date;if(r.setHours(0,0,0,0),l.getTime()<r.getTime()){let d={};return d.notInFuture=i.value,d}else return null}}};t.\u0275fac=function(l){return new(l||t)},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var Te=["expansionPanel"];function Fe(o,t){o&1&&(n(0,"div",20),a(1," Non ci sono ancora rounds in questo evento... "),e())}function Me(o,t){o&1&&(n(0,"div",29),a(1," Non ci sono ancora tavoli in questo round... "),e())}function Ve(o,t){if(o&1){let s=w();n(0,"div",30),c(1,"toFormGroup"),n(2,"span",22),a(3),e(),n(4,"mat-form-field",3)(5,"mat-label"),a(6,"Posti max"),e(),v(7,"input",31),n(8,"mat-error"),a(9),c(10,"formControlError"),e()(),n(11,"div")(12,"strong"),a(13,"OPZIONALI:"),e(),v(14,"br"),a(15," Il sistema cercher\xE0 di assegnare i giocatori puntando al numero di posti ideali "),v(16,"br"),a(17," e riempir\xE0 i tavoli assicurandosi di rispettare i posti minimi. "),e(),n(18,"div",23)(19,"mat-form-field",3)(20,"mat-label"),a(21,"Posti ideali"),e(),v(22,"input",32),n(23,"mat-error"),a(24),c(25,"formControlError"),e()(),n(26,"mat-form-field",3)(27,"mat-label"),a(28,"Posti minimi"),e(),v(29,"input",33),n(30,"mat-error"),a(31),c(32,"formControlError"),e()()(),n(33,"div",14)(34,"button",28),E("click",function(){let r=b(s).$implicit,d=C().$implicit,M=C();return h(M.removeTable(d,r))}),a(35),e()()()}if(o&2){let s=t.$implicit,i=t.index;p("formGroup",u(1,6,s)),m(3),f("Tavolo ",i+1,""),m(6),f(" ",u(10,8,s.get("maximumSeats"))," "),m(15),f(" ",u(25,10,s.get("optimalSeats"))," "),m(7),f(" ",u(32,12,s.get("minimumSeats"))," "),m(4),f(" Elimina Tavolo ",i+1," ")}}function Ge(o,t){if(o&1){let s=w();n(0,"div",21),c(1,"toFormGroup"),n(2,"span",22),a(3),e(),n(4,"div",23)(5,"mat-form-field",3)(6,"mat-label"),a(7,"Inizio"),e(),v(8,"input",24),n(9,"mat-error"),a(10),c(11,"formControlError"),e()(),n(12,"mat-form-field",3)(13,"mat-label"),a(14,"Fine"),e(),v(15,"input",25),n(16,"mat-error"),a(17),c(18,"formControlError"),e()()(),_(19,Me,2,0,"div",26),c(20,"toFormArray"),_(21,Ve,36,14,"div",27),c(22,"toFormArray"),n(23,"div",14)(24,"button",28),E("click",function(){let r=b(s).$implicit,d=C();return h(d.removeRound(r))}),a(25),e(),n(26,"button",15),E("click",function(){let r=b(s).$implicit,d=C();return h(d.addTable(r))}),a(27," Aggiungi un nuovo tavolo "),e()()()}if(o&2){let s=t.$implicit,i=t.index;p("formGroup",u(1,7,s)),m(3),f("",i+1,"\xB0 Round"),m(7),f(" ",u(11,9,s.get("start"))," "),m(7),f(" ",u(18,11,s.get("end"))," "),m(2),p("ngIf",u(20,13,s.get("tables")).value.length<1),m(2),p("ngForOf",u(22,15,s.get("tables")).controls),m(4),f(" Elimina ",i+1,"\xB0 Round ")}}function Oe(o,t){o&1&&(n(0,"mat-card-title"),a(1," Eventi programmati "),e())}function Pe(o,t){o&1&&(n(0,"mat-card-title"),a(1," Nessun evento in programma "),e())}function ke(o,t){o&1&&(n(0,"mat-card-subtitle"),a(1," Qui sotto trovi gli eventi programmati "),e())}function Ne(o,t){o&1&&(n(0,"mat-card-subtitle"),a(1," Crea un nuovo evento dal pannello qui sopra per farlo "),e())}function De(o,t){if(o&1&&(n(0,"div",29)(1,"div"),a(2),e()()),o&2){let s=t.index;m(2),f("Table ",s+1,"")}}function Be(o,t){if(o&1&&(n(0,"div",20)(1,"div"),a(2),e(),_(3,De,3,1,"div",38),e()),o&2){let s=t.$implicit,i=t.index;m(2),f("",i+1,"\xB0 Round"),m(),p("ngForOf",s.tables)}}function Ae(o,t){if(o&1){let s=w();n(0,"mat-card",34)(1,"mat-card-header")(2,"mat-card-title"),a(3),e(),n(4,"mat-card-subtitle"),a(5),c(6,"date"),e()(),n(7,"mat-card-content",34)(8,"div",35),a(9),e(),_(10,Be,4,2,"div",36),e(),n(11,"mat-card-footer")(12,"div",14)(13,"button",37),E("click",function(){let r=b(s).$implicit,d=C();return h(d.deleteEvent(r))}),a(14," Cancella Evento "),e()()()()}if(o&2){let s=t.$implicit,i=C();m(3),T(s.title),m(2),T(u(6,5,s.date)),m(4),T(s.description),m(),p("ngForOf",s.rounds),m(3),p("disabled",i.data.busy)}}function $e(o,t){o&1&&(n(0,"mat-card-title"),a(1," Eventi passati "),e())}function Le(o,t){o&1&&(n(0,"mat-card-title"),a(1," Nessun evento passato registrato "),e())}function Re(o,t){o&1&&(n(0,"mat-card-subtitle"),a(1," Qui sotto trovi gli eventi passati "),e())}function qe(o,t){o&1&&v(0,"mat-card")}var Se=(()=>{let t=class t{constructor(i,l){this.data=i,this.utils=l,this.today=new Date().setHours(0,0,0,0),this.formGroup=new F({title:new x("",[g.required,g.minLength(1)]),description:new x(`Venite a giocare con noi!

L'evento \xE8 aperto a tutt\u0259: giocator\u0259 navigat\u0259 ed espert\u0259 ma anche, e soprattutto, debuttanti desiderosi di imparare.`,[g.required,g.minLength(1)]),date:new x(new Date,[this.utils.futureDateValidator]),location:new x("Spazio L'ove",[g.required,g.minLength(1)]),address:new x("Via Luganetto 1, 6962 Viganello",[g.required,g.minLength(1)]),rounds:new P([],[this.utils.arrayValidator])}),this.createRound=()=>{let r=new x("",[g.required,this.utils.timeValidator]);r.valueChanges.pipe(V(1e3)).subscribe(()=>{this.utils.timeCorrector(r)});let d=new x("",[g.required,this.utils.timeValidator]);return d.valueChanges.pipe(V(1e3)).subscribe(()=>{this.utils.timeCorrector(d)}),new F({start:r,end:d,tables:new P([],this.utils.arrayValidator)})},this.createTable=()=>new F({minimumSeats:new x(0),optimalSeats:new x(0),maximumSeats:new x(0,[g.required,g.min(1)])})}ngOnInit(){return y(this,null,function*(){let i=yield this.data.get("events");this.events=i.filter(l=>new Date(l.date).getTime()>=this.today),this.past=i.filter(l=>new Date(l.date).getTime()<this.today),console.log(this.events,this.past),setTimeout(()=>{console.log("accordion"),this.expansionPanel.close()},1e3)})}addRound(){this.formGroup.get("rounds").push(this.createRound())}removeRound(i){let l=this.formGroup.get("rounds"),r=l.controls.findIndex(d=>d===i);r>=0&&l.removeAt(r)}addTable(i){i.get("tables").push(this.createTable())}removeTable(i,l){let r=i.get("tables"),d=r.controls.findIndex(M=>M===l);d>=0&&r.removeAt(d)}save(){return y(this,null,function*(){this.formGroup.valid&&this.data.post("events",this.formGroup.getRawValue()).then(i=>{this.events.unshift(i),this.formGroup.get("rounds").clear(),this.formGroup.reset(),this.expansionPanel.close()})})}deleteEvent(i){return y(this,null,function*(){this.data.delete(`events/${i._id}`).then(()=>{this.events.splice(this.events.indexOf(i),1)})})}};t.\u0275fac=function(l){return new(l||t)(G(he),G(ye))},t.\u0275cmp=N({type:t,selectors:[["app-events"]],viewQuery:function(l,r){if(l&1&&B(Te,5),l&2){let d;A(d=$())&&(r.expansionPanel=d.first)}},decls:74,vars:35,consts:[[1,"medium"],["expansionPanel",""],[3,"formGroup"],["appearance","outline"],["matInput","","type","text","formControlName","title"],["matInput","","type","text","formControlName","description","rows","10"],["matInput","","formControlName","date",3,"matDatepicker","min"],["matIconSuffix","",3,"for"],["picker",""],[1,"row","ratio25-75"],["matInput","","type","text","formControlName","location","placeholder","Spazio L'ove"],["matInput","","type","text","formControlName","address","placeholder","Via Luganetto 1, 6962 Viganello"],["class","round",4,"ngIf"],["class","round box-shadow",3,"formGroup",4,"ngFor","ngForOf"],[1,"row","end"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","","color","primary",3,"disabled","click"],[4,"ngIf"],["class","event",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"round"],[1,"round","box-shadow",3,"formGroup"],[1,"title"],[1,"row"],["matInput","","type","text","formControlName","start","placeholder","12:00"],["matInput","","type","text","formControlName","end","placeholder","14:00"],["class","table",4,"ngIf"],["class","table",3,"formGroup",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",1,"remove",3,"click"],[1,"table"],[1,"table",3,"formGroup"],["matInput","","type","number","formControlName","maximumSeats"],["matInput","","type","number","formControlName","optimalSeats"],["matInput","","type","number","formControlName","minimumSeats"],[1,"event"],[1,"description"],["class","round",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",3,"disabled","click"],["class","table",4,"ngFor","ngForOf"]],template:function(l,r){if(l&1&&(n(0,"mat-accordion",0)(1,"mat-expansion-panel",null,1)(3,"mat-expansion-panel-header")(4,"mat-panel-title"),a(5," Crea un nuovo evento "),e()(),n(6,"form",2)(7,"strong"),a(8,"Descrizione:"),e(),n(9,"mat-form-field",3)(10,"mat-label"),a(11,"Titolo"),e(),v(12,"input",4),n(13,"mat-error"),a(14),c(15,"formControlError"),e()(),n(16,"mat-form-field",3)(17,"mat-label"),a(18,"Descrizione"),e(),v(19,"textarea",5),n(20,"mat-error"),a(21),c(22,"formControlError"),e()(),n(23,"mat-form-field",3)(24,"mat-label"),a(25,"Data"),e(),v(26,"input",6)(27,"mat-datepicker-toggle",7)(28,"mat-datepicker",null,8),n(30,"mat-hint"),a(31,"DD/MM/YYYY"),e(),n(32,"mat-error"),a(33),c(34,"formControlError"),e()(),n(35,"div",9)(36,"mat-form-field",3)(37,"mat-label"),a(38,"Luogo"),e(),v(39,"input",10),n(40,"mat-error"),a(41),c(42,"formControlError"),e()(),n(43,"mat-form-field",3)(44,"mat-label"),a(45,"Indirizzo"),e(),v(46,"input",11),n(47,"mat-error"),a(48),c(49,"formControlError"),e()()(),_(50,Fe,2,0,"div",12),c(51,"toFormArray"),_(52,Ge,28,17,"div",13),c(53,"toFormArray"),n(54,"div",14)(55,"button",15),E("click",function(){return r.addRound()}),a(56," Aggiungi un nuovo round "),e()(),n(57,"button",16),E("click",function(){return r.save()}),a(58," CREA "),e()()()(),n(59,"mat-card",0)(60,"mat-card-header"),_(61,Oe,2,0,"mat-card-title",17)(62,Pe,2,0,"mat-card-title",17)(63,ke,2,0,"mat-card-subtitle",17)(64,Ne,2,0,"mat-card-subtitle",17),e(),n(65,"mat-card-content"),_(66,Ae,15,7,"mat-card",18),e()(),n(67,"mat-card",0)(68,"mat-card-header"),_(69,$e,2,0,"mat-card-title",17)(70,Le,2,0,"mat-card-title",17)(71,Re,2,0,"mat-card-subtitle",17),e(),n(72,"mat-card-content"),_(73,qe,1,0,"mat-card",19),e()()),l&2){let d=L(29);m(6),p("formGroup",r.formGroup),m(8),f(" ",u(15,21,r.formGroup.get("title"))," "),m(7),f(" ",u(22,23,r.formGroup.get("description"))," "),m(5),p("matDatepicker",d)("min",r.today),m(),p("for",d),m(6),f(" ",u(34,25,r.formGroup.get("date"))," "),m(8),f(" ",u(42,27,r.formGroup.get("location"))," "),m(7),f(" ",u(49,29,r.formGroup.get("address"))," "),m(2),p("ngIf",u(51,31,r.formGroup.get("rounds")).value.length<1),m(2),p("ngForOf",u(53,33,r.formGroup.get("rounds")).controls),m(5),p("disabled",r.data.busy||!r.formGroup.valid),m(4),p("ngIf",(r.events==null?null:r.events.length)>0),m(),p("ngIf",(r.events==null?null:r.events.length)===0),m(),p("ngIf",(r.events==null?null:r.events.length)>0),m(),p("ngIf",(r.events==null?null:r.events.length)===0),m(2),p("ngForOf",r.events),m(3),p("ngIf",(r.past==null?null:r.past.length)>0),m(),p("ngIf",(r.past==null?null:r.past.length)===0),m(),p("ngIf",(r.past==null?null:r.past.length)>0),m(2),p("ngForOf",r.past)}},dependencies:[R,q,U,Z,W,J,K,te,ie,re,le,ae,oe,ne,fe,ve,ge,Ce,_e,xe,Ee,ce,me,se,de,pe,ue,X,ee,j,H,Q,Y],styles:[".round[_ngcontent-%COMP%]{position:relative;margin:0 1rem;border-radius:1rem;display:flex;flex-direction:column;gap:1rem;padding:2rem;background-color:#f7f7f7}.round[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{position:relative;margin:0 1rem;border-radius:1rem;display:flex;flex-direction:column;gap:1rem;padding:2rem;background-color:#dcdcdc}.title[_ngcontent-%COMP%]{position:absolute;top:-.75rem;font-weight:700;background-color:var(--gg-purple)}.event[_ngcontent-%COMP%]{margin-bottom:2rem}.event[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem;gap:.5rem}.event[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{border-left:2px solid rgba(50,50,50,.5);padding:1rem;white-space:break-spaces}.event[_ngcontent-%COMP%]   mat-card-footer[_ngcontent-%COMP%]{padding:1rem}"],data:{animation:[z]}});let o=t;return o})();var je=[{path:"",children:[{path:"",component:Se}]}],Ie=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=S({type:t}),t.\u0275inj=I({imports:[O.forChild(je),O]});let o=t;return o})();var ft=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=S({type:t}),t.\u0275inj=I({imports:[be,Ie]});let o=t;return o})();export{ft as AdminModule};
